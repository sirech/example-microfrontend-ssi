events {
    worker_connections 512;
}

http {
    server {
        listen 8080;
        server_name localhost;

        root /usr/share/nginx/html;
        index index.html;
        ssi on;

        # Redirect / to /browse
        rewrite ^/$ http://localhost:8080/browse redirect;

        # Decide which HTML fragment to insert based on the URL
        location /browse {
            set $PAGE 'browse';
        }

        location /order {
            set $PAGE 'order';
        }

        location /profile {
            set $PAGE 'profile';
        }

        # All locations should render through index.html
        error_page 404 /index.html;
    }
}
